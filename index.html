<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atomic MESH - 引导式 AOB 实验室</title>
    <style>
        :root {
            --bg: #f8fafc;
            --card: #ffffff;
            --accent: #4f46e5;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --text: #0f172a;
            --text-dim: #64748b;
            --border: #e2e8f0;
            --shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            overflow: hidden;
            height: 100vh;
        }

        #app { display: flex; height: 100vh; width: 100vw; overflow: hidden; flex-direction: column; }

        /* 引导式页头 */
        .edu-header {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 20px 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            z-index: 20;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        #ready-status-container {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            min-height: 24px;
        }

        .status-ready {
            font-size: 10px;
            background: #f0fdf4;
            color: var(--success);
            padding: 2px 10px;
            border-radius: 99px;
            border: 1px solid #dcfce7;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .instruction-box {
            background: #f8fafc;
            padding: 12px 16px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
        }

        #instruction-text {
            font-size: 13px;
            line-height: 1.5;
            color: var(--text);
        }

        .step-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .btn-step {
            padding: 8px 20px;
            border-radius: 8px;
            background: var(--accent);
            color: white;
            border: none;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.2);
        }
        .btn-step:hover:not(.inactive) { transform: translateY(-1px); background: #4338ca; }
        .btn-step.inactive {
            background: #f1f5f9;
            color: #94a3b8;
            cursor: not-allowed;
            box-shadow: none;
            border: 1px solid var(--border);
        }

        #project-intro { overflow: hidden; transition: max-height 0.3s ease; max-height: 500px; }
        #project-intro.collapsed { max-height: 0; }
        .intro-text { font-size: 11px; color: var(--text-dim); padding: 6px 0; border-top: 1px dashed var(--border); margin-top: 6px; }
        .toggle-intro { font-size: 10px; color: var(--accent); cursor: pointer; background: none; border: none; text-decoration: underline; padding: 0; text-align: left; margin-top: 4px; }

        .main-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .tabs-nav { display: flex; background: white; padding: 0 40px; border-bottom: 1px solid var(--border); gap: 32px; }
        .tab-btn { padding: 12px 0; font-size: 13px; font-weight: 600; color: var(--text-dim); cursor: pointer; border-bottom: 2px solid transparent; transition: 0.2s; background: none; border: none; outline: none; }
        .tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); }
        .tab-content { flex: 1; padding: 20px 40px; overflow-y: auto; display: none; }
        .tab-content.active { display: block; }

        /* 网格优化：调小 minmax 以容纳更多节点 */
        .node-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; }
        .node-card { background: white; border: 1px solid var(--border); border-radius: 8px; padding: 10px; cursor: pointer; transition: 0.2s; position: relative; }
        .node-card:hover { border-color: var(--accent); box-shadow: var(--shadow); }
        .slots { display: flex; gap: 2px; margin-top: 6px; }
        .slot { width: 6px; height: 6px; border-radius: 1px; background: #f1f5f9; border: 1px solid var(--border); }
        .slot.active { background: var(--success); border-color: var(--success); }

        .chain-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)); gap: 6px; }
        .chain-mini-card { background: white; border: 1px solid var(--border); border-radius: 6px; padding: 4px; text-align: center; cursor: pointer; height: 42px; display: flex; flex-direction: column; justify-content: center; transition: 0.1s; }
        .chain-mini-card:hover { border-color: var(--accent); transform: scale(1.05); z-index: 5; }
        .chain-mini-card.owned { border: 2px solid var(--success); background: #f0fdf4; font-weight: bold; }

        .user-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 12px; }
        .user-profile-card { background: white; border: 1px solid var(--border); border-radius: 10px; padding: 12px; cursor: pointer; }
        .user-profile-card:hover { border-color: var(--accent); box-shadow: var(--shadow); }

        .side-panel { width: 0; opacity: 0; background: #fff; border-left: 1px solid var(--border); height: 100vh; transition: 0.25s ease; display: flex; flex-direction: column; position: fixed; right: 0; top: 0; z-index: 100; }
        .side-panel.open { width: 440px; opacity: 1; box-shadow: -10px 0 40px rgba(0,0,0,0.1); }
        .panel-header { padding: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .panel-body { flex: 1; overflow-y: auto; padding: 20px; }

        .payment-form { background: #f8fafc; border: 1px solid var(--border); border-radius: 8px; padding: 14px; margin-bottom: 20px; }
        .form-label { font-size: 10px; font-weight: 700; color: var(--text-dim); margin-bottom: 4px; display: block; text-transform: uppercase; }
        .form-input { width: 100%; padding: 6px 10px; border-radius: 6px; border: 1px solid var(--border); margin-bottom: 10px; font-size: 12px; font-family: monospace; }
        .btn-action { background: var(--accent); color: white; border: none; padding: 8px; border-radius: 6px; font-weight: 600; cursor: pointer; width: 100%; font-size: 12px; }

        .block-card { background: #f8fafc; border: 1px solid var(--border); border-radius: 8px; padding: 10px; margin-bottom: 10px; position: relative; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0"
  }
}
</script>
</head>
<body>
    <div id="app">
        <header class="edu-header">
            <div id="ready-status-container"></div>
            <div class="instruction-box">
                <div id="instruction-text">
                    <strong>欢迎来到 AOB 实验室！</strong><br>
                    第一步我们需要建立底层的 P2P 通信网络。点击下方按钮，系统将启动 30 个 UUID 虚拟节点，通过公共中继实现互联。
                </div>
                <button class="toggle-intro" onclick="toggleIntro()">[展开/折叠 AOB 核心理论]</button>
                <div id="project-intro" class="collapsed">
                    <div class="intro-text">
                        AOB (Atomic Ownership Blockchain) 为每一项独立资产分配专属区块链。资产转移通过追加新块实现，无需全网共识即可达成秒级验证。
                    </div>
                </div>
            </div>
            <div class="step-actions">
                <div id="active-step-container">
                    <button id="step-1" class="btn-step">1. 建立 P2P 网络</button>
                </div>
                <div id="future-steps" style="display: none;">
                    <button id="step-2" class="btn-step inactive">2. 生成 30 个加密身份</button>
                    <button id="step-3" class="btn-step inactive">3. 创建 500 条区块链</button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <nav class="tabs-nav">
                <button class="tab-btn active" data-tab="tab-nodes">核心节点</button>
                <button class="tab-btn" data-tab="tab-users">加密身份</button>
                <button class="tab-btn" data-tab="tab-blockchain">资产账目</button>
                <button class="tab-btn" data-tab="tab-fastlane">全网日志</button>
            </nav>

            <div id="tab-nodes" class="tab-content active"><div id="grid" class="node-grid"></div></div>
            <div id="tab-users" class="tab-content"><div id="user-list-container" class="user-grid"></div></div>
            <div id="tab-blockchain" class="tab-content"><div id="blockchain-list-container"></div></div>
            <div id="tab-fastlane" class="tab-content">
                <div id="global-log-stream" style="background: #0f172a; color: #10b981; font-family: monospace; padding: 16px; border-radius: 8px; height: 100%; overflow-y: auto; font-size: 11px;"></div>
            </div>
        </main>

        <aside id="side-panel" class="side-panel">
            <div class="panel-header">
                <div>
                    <h2 id="p-title" style="font-size: 16px; font-weight: 800; color: var(--accent);">详情</h2>
                    <span id="p-subtitle" style="font-size: 10px; color: var(--text-dim);">Identity & Asset View</span>
                </div>
                <button id="p-close" style="background:none; border:none; font-size: 24px; cursor:pointer;">&times;</button>
            </div>
            <div id="p-body" class="panel-body"></div>
        </aside>
    </div>
    <script type="module" src="index.js"></script>
    <script>
        function toggleIntro() { document.getElementById('project-intro').classList.toggle('collapsed'); }
    </script>
</body>
</html>